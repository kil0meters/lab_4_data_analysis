---
title: "Lab 4 Data Analysis"
author: "Lab 4 Data Analysis Committee"
date: "2/23/2022"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

```{r}
data <- read.csv("./data.csv")
```

```{r}
force_areas <- function(positive_force, negative_force) {
  i <- 1
  positive_sum <- 0
  negative_sum <- 0
  
  positive_median <- median(positive_force)
  negative_median <- median(negative_force)
  
  for (i in 1:251) {
    positive_sum <- positive_sum + positive_force[i] - positive_median;
    negative_sum <- negative_sum + negative_force[i] - negative_median;
    
  }
  
  positive_total_force <- positive_sum * 0.01
  negative_total_force <- negative_sum * 0.01
  
  c(positive_total_force, negative_total_force)
}
```

```{r}
test_trial <- function(start, end) {
  results <- data.frame()
  
  for (i in start:end) {
    x_name <- paste("Data.Set.", i, "..Force.G..N.", sep="")
    y_name <- paste("Data.Set.", i, "..Force.Y..N.", sep="")
    
    m <- force_areas(data[, x_name], data[, y_name])
    results <- rbind(results, data.frame(yellow.car=m[1], blue.car=m[2]))
  }
  
  results
}

```

```{r}
calc_err <- function(data) {
  yellow.car.err <- (max(data$yellow.car) - min(data$yellow.car)) / 2
  blue.car.err <- (max(data$blue.car) - min(data$blue.car)) / 2
  
  data.frame(yellow.car.err, blue.car.err)
}
```

### Experiment 1

Moving heavy car (yellow) colliding with moving light car (blue)

```{r}
exp.1.data <- test_trial(1,5)
calc_err(exp.1.data)
```

```{r}
exp.1.data
```

### Experiment 2

Moving heavy car (yellow) colliding with stationary light car (blue)

```{r}
exp.2.data <- test_trial(6,10)
calc_err(exp.2.data)
```

```{r}
exp.2.data
```

### Experiment 3

Moving light car (blue) colliding with stationary heavy car (yellow)

```{r}
exp.3.data <- test_trial(11,15)
calc_err(exp.3.data)
```

```{r}
exp.3.data
```

### Experiment 4

Moving light car (yellow) colliding with moving light car (blue)

```{r}
exp.4.data <- test_trial(16,20)
calc_err(exp.4.data)
```

```{r}
exp.4.data
```